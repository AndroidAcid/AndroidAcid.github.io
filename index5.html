<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Neon Vertical Shooter</title>
<style>
html, body {
  margin: 0;
  background: black;
  overflow: hidden;
}
canvas {
  display: block;
  width: 100vw;
  height: 100vh;
}
.hint {
  position: fixed;
  left: 12px;
  bottom: 10px;
  color: #9ff;
  font: 12px monospace;
  opacity: 0.8;
  user-select: none;
}
</style>
</head>

<body>
<canvas id="c"></canvas>
<div class="hint">Move: WASD / Arrows · Fire: Space · Click once for sound</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d", { alpha: false });
const DPR = devicePixelRatio;

function resize() {
  canvas.width = innerWidth * DPR;
  canvas.height = innerHeight * DPR;
}
addEventListener("resize", resize);
resize();

/* ================= INPUT ================= */
const keys = new Set();
addEventListener("keydown", e => keys.add(e.code));
addEventListener("keyup", e => keys.delete(e.code));

/* ================= UTILS ================= */
const rand = (a,b)=>a+Math.random()*(b-a);
const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));
const W=()=>canvas.width, H=()=>canvas.height;

function hit(a,b){
  const dx=a.x-b.x, dy=a.y-b.y;
  return dx*dx+dy*dy < (a.r+b.r)**2;
}

/* ================= AUDIO ================= */
const AC = new (window.AudioContext||webkitAudioContext)();
addEventListener("click", () => {
  if (AC.state === "suspended") AC.resume();
}, { once:true });

function beep(freq,dur,type="sine",vol=0.15){
  const o=AC.createOscillator();
  const g=AC.createGain();
  o.type=type;
  o.frequency.value=freq;
  g.gain.value=vol;
  o.connect(g);
  g.connect(AC.destination);
  o.start();
  g.gain.exponentialRampToValueAtTime(0.001, AC.currentTime + dur);
  o.stop(AC.currentTime + dur);
}

/* ================= GAME STATE ================= */
let time=0, score=0, shake=0, diff=0;
const bullets=[], enemies=[], particles=[];

const player = { x:0, y:0, r:16, fire:0, rate:0.09 };
function resetPlayer(){
  player.x = W()/2;
  player.y = H()*0.82;
}
resetPlayer();

/* ================= PARTICLES ================= */
function burst(x,y,h,n=30,p=1){
  for(let i=0;i<n;i++){
    const a=Math.random()*6.28;
    const s=rand(100,600)*p;
    particles.push({
      x,y,
      vx:Math.cos(a)*s,
      vy:Math.sin(a)*s,
      life:rand(0.3,0.8),
      r:rand(2,5),
      h:(h+rand(-40,40)+360)%360
    });
  }
}

/* ================= ENEMIES ================= */
function spawnEnemy(){
  const shapes=["circle","square","diamond","star"];
  const r=rand(14,26);
  enemies.push({
    x:rand(r,W()-r),
    y:-40,
    r,
    vy:rand(140,280),
    wob:rand(1,3),
    ph:rand(0,6.28),
    hp:Math.random()<0.25?3:1,
    h:rand(0,360),
    rot:rand(0,6.28),
    rs:rand(-2,2),
    shape:shapes[Math.floor(Math.random()*clamp(1+diff,1,shapes.length))]
  });
}

/* ================= DRAW SHAPES ================= */
function drawShape(e){
  ctx.save();
  ctx.translate(e.x,e.y);
  ctx.rotate(e.rot + time*e.rs);
  ctx.fillStyle=`hsl(${e.h},100%,60%)`;
  ctx.beginPath();

  const s=e.r;
  if(e.shape==="circle") ctx.arc(0,0,s,0,6.28);
  else if(e.shape==="square") ctx.rect(-s,-s,s*2,s*2);
  else if(e.shape==="diamond"){
    ctx.moveTo(0,-s); ctx.lineTo(s,0);
    ctx.lineTo(0,s); ctx.lineTo(-s,0);
    ctx.closePath();
  }
  else {
    const spikes=6;
    for(let i=0;i<spikes*2;i++){
      const a=i*Math.PI/spikes;
      const r=i%2?s*0.45:s;
      ctx.lineTo(Math.cos(a)*r,Math.sin(a)*r);
    }
  }

  ctx.fill();
  ctx.restore();
}

/* ================= VISUAL FX ================= */
function drawBG(){
  ctx.fillStyle="rgba(0,0,0,0.18)";
  ctx.fillRect(0,0,W(),H());

  ctx.globalAlpha=0.1;
  for(let i=0;i<20;i++){
    const y=(i*H()/20 + time*140)%H();
    ctx.fillStyle=`hsl(${(time*60+i*20)%360},100%,60%)`;
    ctx.fillRect(0,y,W(),H()/40);
  }
  ctx.globalAlpha=1;
}

function scanlines(){
  ctx.globalAlpha=0.12;
  ctx.fillStyle="#000";
  for(let y=0;y<H();y+=4*DPR)
    ctx.fillRect(0,y,W(),2*DPR);
  ctx.globalAlpha=1;
}

function chroma(){
  const s=Math.sin(time*5)*3*DPR;
  ctx.globalAlpha=0.35;
  ctx.drawImage(canvas,-s,0);
  ctx.drawImage(canvas,s,0);
  ctx.globalAlpha=1;
}

/* ================= MAIN LOOP ================= */
let last=performance.now(), spawnT=0;

function step(now){
  const dt=Math.min(0.033,(now-last)/1000);
  last=now;
  time+=dt;
  diff+=dt*0.04;

  spawnT-=dt;
  if(spawnT<=0){
    spawnT=clamp(0.5-diff*0.2,0.14,0.5);
    spawnEnemy();
    if(Math.random()<diff*0.25) spawnEnemy();
  }

  // movement
  player.x+=((keys.has("KeyD")||keys.has("ArrowRight"))-(keys.has("KeyA")||keys.has("ArrowLeft")))*900*dt;
  player.y+=((keys.has("KeyS")||keys.has("ArrowDown"))-(keys.has("KeyW")||keys.has("ArrowUp")))*900*dt;
  player.x=clamp(player.x,player.r,W()-player.r);
  player.y=clamp(player.y,player.r,H()-player.r);

  // firing
  player.fire-=dt;
  if(keys.has("Space") && player.fire<=0){
    player.fire=player.rate;
    bullets.push({x:player.x,y:player.y-20,r:4,vy:-1200,h:(time*120)%360});
    burst(player.x,player.y-18,(time*120)%360,8,0.6);
    beep(880,0.05,"square",0.08);
  }

  bullets.forEach(b=>b.y+=b.vy*dt);
  enemies.forEach(e=>{
    e.ph+=dt*e.wob;
    e.x+=Math.sin(e.ph)*120*dt;
    e.y+=e.vy*dt;
  });

  for(let i=enemies.length-1;i>=0;i--){
    const e=enemies[i];
    for(let j=bullets.length-1;j>=0;j--){
      if(hit(e,bullets[j])){
        bullets.splice(j,1);
        e.hp--;
        shake=16;
        burst(e.x,e.y,e.h,24,1.2);
        beep(240,0.07,"sawtooth",0.12);
        if(e.hp<=0){
          enemies.splice(i,1);
          score+=10;
          burst(e.x,e.y,e.h,48,1.6);
          beep(90,0.2,"triangle",0.2);
        }
        break;
      }
    }
    if(hit(e,player)){
      shake=30;
      burst(player.x,player.y,(time*100)%360,80,2);
      beep(40,0.5,"sine",0.25);
      enemies.length=0; bullets.length=0;
      resetPlayer();
      break;
    }
  }

  for(let i=particles.length-1;i>=0;i--){
    const p=particles[i];
    p.life-=dt;
    p.x+=p.vx*dt;
    p.y+=p.vy*dt;
    p.vx*=0.96; p.vy*=0.96;
    if(p.life<=0) particles.splice(i,1);
  }

  drawBG();

  const sx=(Math.random()*2-1)*shake;
  const sy=(Math.random()*2-1)*shake;
  shake=Math.max(0,shake-dt*40);

  ctx.save();
  ctx.translate(W()/2+sx,H()/2+sy);
  ctx.scale(1+Math.sin(time*4)*0.006,1+Math.sin(time*4)*0.006);
  ctx.translate(-W()/2,-H()/2);

  ctx.globalCompositeOperation="lighter";
  enemies.forEach(drawShape);

  bullets.forEach(b=>{
    ctx.fillStyle=`hsl(${b.h},100%,70%)`;
    ctx.fillRect(b.x-2,b.y-8,4,16);
  });

  particles.forEach(p=>{
    ctx.globalAlpha=p.life;
    ctx.fillStyle=`hsl(${p.h},100%,70%)`;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,6.28);
    ctx.fill();
  });
  ctx.globalAlpha=1;

  ctx.fillStyle=`hsl(${time*120%360},100%,65%)`;
  ctx.beginPath();
  ctx.moveTo(player.x,player.y-20);
  ctx.lineTo(player.x-14,player.y+16);
  ctx.lineTo(player.x+14,player.y+16);
  ctx.fill();

  ctx.restore();
  chroma();
  scanlines();

  ctx.fillStyle="#9ff";
  ctx.font=`${16*DPR}px monospace`;
  ctx.fillText("SCORE "+score,14,26);

  requestAnimationFrame(step);
}

requestAnimationFrame(step);

});
</script>
</body>
</html>

